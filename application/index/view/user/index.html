<div>
  <h2>USER LIST</h2>
  <!-- application/view/index/index.html -->
  <a href="{:url('user/create')}">
    <button>Create New User</button>
  </a>

  <table>
    <tr>
      <th>ID</th>
      <th>First Name</th>
      <th>Last Name</th>
      <th>Gender</th>
      <th>Status</th>
      <th>Action</th>
    </tr>
    {volist name="users" id="user"}
    <tr>
      <td>{$user.id}</td>
      <td>{$user.first_name}</td>
      <td>{$user.last_name}</td>
      <td>{$user.gender}</td>
      <td>{$user.status}</td>
      <td>
        <a href="{:url('user/edit', ['id'=>$user.id])}">Edit</a>
        <!-- <a href="{:url('user/delete/:id', ['id' => $user.id])}">Delete</a> -->
        <a href="javascript:void(0);" onclick="deleteUser('{$user.id}')"
          >Delete</a
        >
      </td>
    </tr>
    {/volist}
  </table>
</div>
<script>
  function deleteUser(userId) {
    if (confirm("Are you sure you want to delete this user?")) {
      fetch(`/users/${userId}`, {
        method: "DELETE",
        headers: {
          "X-Requested-With": "XMLHttpRequest",
          "Content-Type": "application/json",
        },
      })
        .then((response) => {
          if (response.ok) {
            alert("User deleted successfully!");
            location.reload(); // Reload the page
          } else {
            alert("Failed to delete user.");
          }
        })
        .catch((error) => {
          console.error("Error deleting user:", error);
          alert("An error occurred while deleting the user.");
        });
    }
  }
</script>
<!-- <p>{$username}</p> -->
